library(data.table)
library(GenomicRanges)
pid.sv.dir<-'/scratch/WGS10K/data/release/20161012-A/merged-sv/all'
data.dir<-'/scratch/ob219/pid/'
mfiles<-list.files(path=pid.sv.dir,pattern='filt*.*txt',full.names=TRUE)
##CANVAS - insertion deletions based on read depth
##MANTA - translocations, deletions, tandem duplications, insertions, and inversions based on both paired read fragment spanning and split read evidence
canvas<-mfiles[grepl("canvas",mfiles)]
## process canvas
DT<-fread(canvas[1])
## load in the file of bridge pid cases
id.file<-fread(file.path(data.dir,'BRIDGE-PID_20161012release_846_index_cases.csv'))
setnames(id.file,make.names(names(id.file)))
DT<-subset(DT,ILMN_ID %in% id.file$Illumina.ID)
DT$id<-1:nrow(DT)
sv.gr<-with(DT,GRanges(seqnames=Rle(CANVAS_CHROM),ranges=IRanges(start=CANVAS_START,end=CANVAS_END),id=id))

##load the pchic SE overlaps merge.results.se
load(file.path(data.dir,'hnisz_SE_annotation.RData'))
m<-merge.results.se[[1]]
canvas[DT$id %in% subsetByOverlaps(sv.gr,m$se.gr)$id,]





manta<-mfiles[grepl("manta",mfiles)]
